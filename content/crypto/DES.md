---
title: "DES"
tags:
- crypto
---

> [!warning]
>  `DES`算法在目前已经不具有安全性，我们可以使用硬件快速爆破`DES`密钥。且`DES`在加密效率上只有高效的硬件实现而没有高效的软件实现，不推荐在现代基础设施上使用此加密算法。

本页面主要介绍`DES`算法，`DES`是一种使用 56 位密钥(实际上，我们一般看到 64 位的密钥中有 8 位校验位无法参与加密)对 64 位长分组进行加密的密码。

## 加密

其具体加密给出的流程图如下:

![DES Flow](https://img.gejiba.com/images/faed068123175795e20491afa18d9bb8.png)

上述步骤可用文字表述如下:
1. 明文被分解成以 64 bit 为一组的数据 
2. 将 64 bit 为一组的明文 $x$ 使用 [[crypto/concept/初始置换与逆置换|初始置换]] $IP(x)$ 进行处理
3. 将置换后的结果分为左右两部分，每一部分长度为 32 bit，分别记为$L_0$、$R_0$
4. 将右侧 $L_0$ 部分(32 bit) 与经过 [[crypto/concept/密钥编排|密钥编排]](`Key schedule`) 后的 48 bit 密钥输入 f 函数
5. 将 [[crypto/concept/F函数|f函数]] 输出结果与左侧$R_0$进行异或获得的结果记为$R_1$
6. 将原有输入 $R_0$ 直接记为 $L_1$

我们将上述 3 - 6 步流程重复 16 轮，最后获得结果进行 [[crypto/concept/初始置换与逆置换|初始逆置换]]输出密文。

上述结构被称为`Feistel 网络`，其数学表达形式如下:
$$L_i = R_{i-1} $$
$$R_i = L_{i-1} \oplus f(R_{i-1}, k_i)$$

其中，各参数的含义均可以在`Ferstel 网络`的结构图中获得。

我们可以认为在`DES`加密流程内，我们使用右侧数据、密钥和 [[crypto/concept/F函数|f函数]] 构造了一个随机数生成器以加密左侧。

## 解密

解密的流程图如下：

![DES decrypt](https://img.gejiba.com/images/16f368123ea7fb6a7d6e1879ccf0d551.png)

与加密相比，在解密中，我们逆转了[[crypto/concept/密钥编排|密钥编排]]部分。正如我们在密钥编排内提到的结论，即：
$$C_0 = C_{16}$$
$$D_0 = D_{16}$$
基于上述结论，我们可以得到加密过程中使用的 $k_{16}$ 密钥，获得此密钥后我们可以正确解密第 16 轮加密。同时，我们可以通过在解密过程中使用向右移位的 $RS_i$  替代加密过程中向左移位的 $LS_i$  获得正确的 $k_{15}$ 等密钥。

> 向左移位与向右移位显然属于逆操作

总体来说，密钥编排流程图如下：

![DES Decrypt Key Schedule](https://img.gejiba.com/images/716c31a22c6b194c99b74f7c22bee0b4.png)

